on_actions = {
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM = {
						is_in_array = {
							array = st_transfer_states_ar
							value = FROM.FROM.id
						}
					}
				}
				FROM = {
					remove_from_array = {
						array = st_transfer_states_ar
						value = FROM.FROM.id
					}
				}
			}
			if = {
				limit = {
					FROM = {
						is_in_array = {
							array = pt_transfer_states_ar
							value = FROM.FROM.id
						}
					}
				}
				FROM = {
					remove_from_array = {
						array = pt_transfer_states_ar
						value = FROM.FROM.id
					}
				}
			}
		}
	}

	on_daily = { # I know on_daily isn't the best on performance, but it's the most ideal for my goal
		effect = {
			if = {
				limit = {
					has_game_rule = {
						rule = pm_pt_coloring_status
						option = pm_pt_yes_coloring
					}
				}
				every_subject_country = {
					limit = {
						NOT = { has_variable = pm_pt_color_var }
						OR = {
							is_subject_of = ENG
							is_subject_of = GER
							is_subject_of = SOV
							is_subject_of = AUS
							is_subject_of = USA
							is_subject_of = JAP
							is_subject_of = FRA
							is_subject_of = POL
							is_subject_of = HUN
							is_subject_of = ITA
							is_subject_of = AST
							is_subject_of = SPR
							is_subject_of = ROM
							is_subject_of = CHI
							is_subject_of = PRC
						}
					}
					if = {
						limit = {
							OVERLORD = {
								original_tag = SOV
								NOT = { has_government = communism }
							}
						}
						set_cosmetic_tag = RUS_PUPPET
					}
					else = {
						meta_effect = {
							text = { set_cosmetic_tag = [TAG]_PUPPET }
							TAG = "[OVERLORD.GetTag]"
						}
					}
					set_variable = { pm_pt_color_var = 1 }
				}
			}
		}
	}

	on_subject_free = {
		effect = {
			if = {
				limit = {
					is_dynamic_country = yes
				}
				drop_cosmetic_tag = yes
				
				if = {
					limit = {
						any_other_country = {
							original_tag = ROOT
							has_government = ROOT
							is_dynamic_country = no
						}
					}
					random_country_with_original_tag = {
						original_tag_to_check = ROOT
						limit = {
							has_government = ROOT
						}
						country_event = {
							id = occupied_countries.1
							hours = 24
							random_hours = 12
						}
					}
				}
				else_if = {
					limit = {
						NOT = {
							any_other_country = {
								original_tag = ROOT
								is_dynamic_country = no
							}
						}
					}
					every_possible_country = {
						limit = {
							original_tag = ROOT
							is_dynamic_country = no
							exists = no
						}
						ROOT = {
							random_owned_controlled_state = {
								limit = {
									is_core_of = PREV
								}
								transfer_state_to = PREV
							}
						}
						change_tag_from = ROOT
						annex_country = {
							target = ROOT
							transfer_troops = yes
						}
					}
				}
			}
			if = {
				limit = {
					has_variable = pm_pt_color_var
				}
				drop_cosmetic_tag = yes
				clear_variable = pm_pt_color_var
			}
		}
	}
	on_subject_annexed = {
		effect = {
			if = {
				limit = {
					has_variable = pm_pt_color_var
				}
				drop_cosmetic_tag = yes
				clear_variable = pm_pt_color_var
			}
		}
	}
	on_release_as_free = {
		effect = {
			if = {
				limit = {
					has_variable = pm_pt_color_var
				}
				drop_cosmetic_tag = yes
				clear_variable = pm_pt_color_var
			}
		}
	}
	on_puppet = {
		effect = {
			if = {
				limit = {
					has_variable = pm_pt_color_var
				}
				drop_cosmetic_tag = yes
				clear_variable = pm_pt_color_var
			}
		}
	}
}